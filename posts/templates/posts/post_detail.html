{% extends 'base.html' %}

{% block title%} Blog Detail {% endblock %}

{% block breadcrumb %}
	<li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
  	<li class="breadcrumb-item"><a href="{% url 'posts:list' %}">Post List</a></li>
  	<li class="breadcrumb-item active">Post Details</li>
{% endblock %}

{% block content %}

<div class="container">
	{% include 'includes/messages.html' %}

	<h2>{{ post.title }}</h2>
	<h6>By: {{ post.user }}.</h6>
	<h6>Published on: {{ post.publish }} Last Updated: {{ post.updated }} Comments: {{ post.comments.count }}. View: {{ post.views }}. read time: {{ post.read_time }} min.</h6>

	<p>{{ post.content|linebreaks }}</p>

	<h3>Comments</h3>
	{% if user.is_authenticated %}
		
		<form action="." method="POST"> {% csrf_token %}
			{% include 'includes/form-snippet.html' %}
			<button type="submit" class="btn btn-primary">Comment</button>
		</form>
	{% else %}
			<strong><a href="{% url 'accounts:login' %}">Login</a> or <a href="{% url 'accounts:signup' %}">Register</a> to comment.</strong>
	{% endif %}
		
			<ul>
			<hr>
				<h5>Latest comments</h5>
				{% for comment in post.comments.all %}
					{% if not comment.parent %}	
					<div class="card">
					  <div class="card-header">
					     <h6>By: {{ comment.user }}. <small>on -{{ comment.timestamp }} last updated: {{ comment.updated }}</small></h6> 
					  </div>
					  <div class="card-block">
					    <h4 class="card-title"></h4>
					    <p class="card-text">{{ comment.content }}</p>
					  {% if user.is_authenticated %}
						  	<a href="#" class="btn btn-primary" role="button"> Reply </a>
					  {% else %}
							<strong><a href="{% url 'accounts:login' %}">Login</a> or <a href="{% url 'accounts:signup' %}">Register</a> to Reply.</strong>
							<a href="#" class="btn btn-primary btn-sm" role="button"> View Replies </a>
					   {% endif %}

					  </div>
					</div>
					{% endif %}
				{% empty %}
					<span>No Comments yet!</span>
				{% endfor %}
			</ul>
		
</div>



{% endblock %}